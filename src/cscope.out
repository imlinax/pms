cscope 15 $HOME/develop/c/pms/src -q 0000000092 0000009802
	@employee.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~"em¶oy“.h
"

4 
	gemid
=0;

5 
	$show_®l_emšfo
(
EMPLOYEE
* 
em_h—d
)

7 
EMPLOYEE
* 
±mp
=
em_h—d
->
Ãxt
;

8 if(
±mp
==
NULL
)

10 
	`´štf
("æš‚æ— å‘˜å·¥ä¿¡æ¯\n");

11 
	`£tbuf
(
¡dš
,
NULL
);

12 
	`g‘ch¬
();

15 
±mp
!=
NULL
)

17 
	`show_em¶oy“
(
±mp
);

18 
±mp
õtmp->
Ãxt
;

20 
	`£tbuf
(
¡dš
,
NULL
);

21 
	`g‘ch¬
();

23 
	}
}

24 
	$show_em¶oy“
(
EMPLOYEE
* 
³m
)

26 *
t™Ë
[]={"åˆçº§","ä¸­çº§","é«˜çº§"};

27 if(
³m
==
NULL
)

31 
	`´štf
("ID:%d\n",
³m
->
id
);

32 
	`´štf
("å§“å:%s\n",
³m
->
Çme
);

33 
	`´štf
("èŒç§°:%s\n",
t™Ë
[
³m
->title]);

34 
	`´štf
("åŸºæœ¬è–ªèµ„:%då…ƒ\n",
³m
->
§Ïy
);

35 if(
³m
->
Úlše
)

37 
	`´štf
("å·¥ä½œçŠ¶æ€:åœ¨èŒ\n");

42 
	`´štf
("å·¥ä½œçŠ¶æ€:ç¦»èŒ\n");

44 
	}
}

45 
	$add_em¶oy“
(
EMPLOYEE
 *
em_h—d
,EMPLOYEE *
³m
)

47 
EMPLOYEE
 *
±mp
=
em_h—d
;

48 if(
³m
==
NULL
)

50 
	`årštf
(
¡d”r
,"å‘˜å·¥ä¿¡æ¯ä¸ºç©º,æ·»åŠ å¤±è´¥\n");

53 
±mp
->
Ãxt
!=
NULL
)

55 
±mp
õtmp->
Ãxt
;

57 
³m
->
Ãxt
=
NULL
;

58 
±mp
->
Ãxt
=
³m
;

60 
	}
}

62 
	$g‘_em¶oy“_couÁ
(
EMPLOYEE
* 
em_h—d
)

64 
couÁ
=0;

65 if(
em_h—d
==
NULL
)

67 
	`årštf
(
¡d”r
,"å‘˜å·¥é“¾è¡¨é”™è¯¯");

70 
EMPLOYEE
 *
±mp
=
em_h—d
;

71 
±mp
->
Ãxt
!=
NULL
)

73 
couÁ
++;

74 
±mp
õtmp->
Ãxt
;

76  
couÁ
;

77 
	}
}

78 
	$d–‘e_em_by_id
(
EMPLOYEE
* 
em_h—d
,
id
)

80 
EMPLOYEE
* 
±emp
=
em_h—d
;

81 if(
±emp
==
NULL
)

83 
	`årštf
(
¡d”r
,"employee†istƒrror\n");

84 
	`ex™
(0);

86 
±emp
->
Ãxt
!=
NULL
)

88 if(
±emp
->
Ãxt
->
id
==id)

90 
±emp
->
Úlše
=0;

96 
	}
}

	@employee.h

1 #iâdeà
_EMPLOYEES_H


2 
	#_EMPLOYEES_H


	)

4 
	#EMP_SAVE_SIZE
 ((
EMPLOYEE
)-(EMPLOYEE*))

	)

5 
	sem¶oy“


7 
	mid
;

8 
	mÇme
[32];

9 
	mt™Ë
;

10 
	m§Ïy
;

11 
	mÚlše
;

12 
em¶oy“
* 
	mÃxt
;

13 }
	tEMPLOYEE
;

15 
show_®l_emšfo
(
EMPLOYEE
* 
em_h—d
);

16 
show_em¶oy“
(
EMPLOYEE
* 
³m
);

17 
g‘_em¶oy“_couÁ
(
EMPLOYEE
* 
em_h—d
);

18 
d–‘e_em_by_id
(
EMPLOYEE
* 
em_h—d
,
id
);

20 
emid
;

	@fileop.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~"em¶oy“.h
"

4 
	~"»w¬dpunish.h
"

5 
	~"glob®.h
"

6 
	~"feİ.h
"

10 
GINFO
 *
	$lßd_®l
(
FILE
 *
åem
,FILE *
å½
)

12 
GINFO
 *
pgšfo
=(GINFO*)
	`m®loc
((GINFO));

13 
	`f£ek
(
åem
,0,
SEEK_SET
);

14 
	`f£ek
(
å½
,0,
SEEK_SET
);

15 if(
	`ä—d
(
pgšfo
,(
GINFO
),1,
åem
)<1)

17 
	`årštf
(
¡d”r
,"åŠ è½½é…ç½®æ–‡ä»¶å¤±è´¥!\n");

18 
	`ex™
(1);

20 
pgšfo
->
em_h—d
=
	`lßd_em¶oy“s
(
åem
,pgšfo->
em_couÁ
);

21 
pgšfo
->
½_h—d
=
	`lßd_»w¬dpunish
(
å½
,pgšfo->
½_couÁ
);

23  
pgšfo
;

24 
	}
}

28 
EMPLOYEE
 *
	$lßd_em¶oy“s
(
FILE
 *
å
,
couÁ
)

30 
i
=0;

35 
EMPLOYEE
* 
ph—d
=(EMPLOYEE*)
	`ÿÎoc
(1,
EMP_SAVE_SIZE
);

36 
EMPLOYEE
* 
±mp
=
ph—d
;

37 
	`f£ek
(
å
,(
GINFO
),
SEEK_SET
);

38 if(
ph—d
==
NULL
)

40 
	`årštf
(
¡d”r
,"memory‡llocationƒrror!\n");

41 
	`ex™
(1);

43 
i
=0;i<
couÁ
;i++)

45 
±mp
->
Ãxt
=(
EMPLOYEE
*)
	`m®loc
(
EMP_SAVE_SIZE
);

46 if(
±mp
->
Ãxt
==
NULL
)

48 
	`årštf
(
¡d”r
,"memory‡llocationƒrror!\n");

49 
	`ex™
(1);

51 
	`ä—d
(
±mp
->
Ãxt
,
EMP_SAVE_SIZE
,1,
å
);

52 
±mp
õtmp->
Ãxt
;

54 
±mp
->
Ãxt
=
NULL
;

55  
ph—d
;

56 
	}
}

60 
RP
 *
	$lßd_»w¬dpunish
(
FILE
 *
å
,
couÁ
)

62 
i
=0;

63 if(
couÁ
<1)

65  
NULL
;

67 
RP
 * 
ph—d
=(RP*)
	`ÿÎoc
(1,
RP_SAVE_SIZE
);

68 
RP
 * 
±mp
=
ph—d
;

69 
	`f£ek
(
å
,(
GINFO
),
SEEK_SET
);

70 if(
±mp
==
NULL
)

72 
	`ex™
(1);

74 
i
=0;i<
couÁ
;i++)

76 
±mp
->
Ãxt
=(
RP
*)
	`m®loc
(
RP_SAVE_SIZE
);

77 if(
±mp
->
Ãxt
==
NULL
)

79 
	`årštf
(
¡d”r
,"memory‡llocationƒrror!\n");

80 
	`ex™
(1);

82 
	`ä—d
(
±mp
->
Ãxt
,(
RP_SAVE_SIZE
),1,
å
);

83 
±mp
õtmp->
Ãxt
;

85 
±mp
->
Ãxt
=
NULL
;

86  
ph—d
;

87 
	}
}

92 
	$§ve_®l
(
FILE
 *
å
,
GINFO
* 
pgšfo
)

94 if(
å
==
NULL
)

98 
	`f£ek
(
å
,0,
SEEK_SET
);

99 if(
	`fwr™e
(
pgšfo
,(
GINFO
),1,
å
)!=1)

101 
	`årštf
(
¡d”r
,"save fileƒrror!\n");

102 
	`ex™
(1);

105 
	}
}

109 
	$§ve_em¶oy“s
(
FILE
 *
å
,
EMPLOYEE
* 
em_h—d
)

111 
EMPLOYEE
* 
³m
=
em_h—d
->
Ãxt
;

112 if(
å
==
NULL
)

116 
	`f£ek
(
å
,(
GINFO
),
SEEK_SET
);

117 
³m
!=
NULL
)

119 if(
	`fwr™e
(
³m
,
EMP_SAVE_SIZE
,1,
å
)!=1)

121 
	`årštf
(
¡d”r
,"save fileƒrror!\n");

122 
	`ex™
(0);

124 
³m
õem->
Ãxt
;

127 
	}
}

131 
	$§ve_»w¬dpunish
(
FILE
 *
å
,
RP
* 
´p
)

134 
	}
}

	@fileop.h

1 #iâdeà
_FILEOP_H


2 
	#_FILEOP_H


	)

4 
	~<¡dio.h
>

5 
	~"glob®.h
"

6 
	~"em¶oy“.h
"

7 
GINFO
 *
lßd_®l
(
FILE
 *
åem
,FILE*
å½
);

8 
EMPLOYEE
 *
lßd_em¶oy“s
(
FILE
 *
å
,
couÁ
);

9 
RP
 *
lßd_»w¬dpunish
(
FILE
 *
å
,
couÁ
);

11 
§ve_®l
(
FILE
 *
å
,
GINFO
* 
pgšfo
);

12 
§ve_em¶oy“s
(
FILE
 *
å
,
EMPLOYEE
*);

13 
§ve_»w¬dpunish
(
FILE
 *
å
,
RP
*);

	@global.h

1 #iâdeà
_GLOBAL_H


2 
	#_GLOBAL_H


	)

3 
	~"em¶oy“.h
"

4 
	~"»w¬dpunish.h
"

5 
	sglob®_šfo


7 
	mem_couÁ
;

8 
	m½_couÁ
;

9 
EMPLOYEE
 *
	mem_h—d
;

10 
RP
 *
	m½_h—d
;

11 
	memid
;

13 }
	tGINFO
;

	@init.c

1 
	~<¡dlib.h
>

2 
	~<¡dio.h
>

3 
	~"glob®.h
"

4 
	~"feİ.h
"

5 
	~"š™.h
"

9 
GINFO
* 
	$š™_sys
()

11 
FILE
 *
åem
;

12 
FILE
 *
å½
;

13 
GINFO
* 
pgšfo
=(GINFO *)
	`m®loc
((GINFO));

14 
pgšfo
->
em_couÁ
=0;

15 
pgšfo
->
½_couÁ
=0;

16 
pgšfo
->
em_h—d
=
NULL
;

17 
pgšfo
->
½_h—d
=
NULL
;

18 
pgšfo
->
emid
=0;

19 if(
	`š™_fes
(&
åem
,&
å½
)==0)

21 
	`§ve_®l
(
åem
,
pgšfo
);

22 
	`§ve_®l
(
å½
,
pgšfo
);

27 
pgšfo
=
	`lßd_®l
(
åem
,
å½
);

28 
emid
=
pgšfo
->emid;

29 
	`fşo£
(
åem
);

30 
	`fşo£
(
å½
);

31  
pgšfo
;

32 
	}
}

36 
	$š™_fes
(
FILE
 **
åem
,FILE **
å½
)

38 
FILE
 *
å_em¶oy“
=
NULL
;

39 
FILE
 *
å_»w¬dpunish
=
NULL
;

40 
å_em¶oy“
=
	`fİ’
("../data/emdata","rb");

41 
å_»w¬dpunish
=
	`fİ’
("../data/rpdata","rb");

42 if((
å_em¶oy“
==
NULL
è|| (
å_»w¬dpunish
==NULL))

44 
å_em¶oy“
=
	`fİ’
("../data/emdata","wb+");

45 if(
å_em¶oy“
==
NULL
)

47 
	`årštf
(
¡d”r
,"æ— æ³•åˆ›å»ºæ–‡ä»¶!\n");

48 
	`ex™
(1);

50 
å_»w¬dpunish
=
	`fİ’
("../data/rpdata","wb+");

52 if(
å_»w¬dpunish
==
NULL
)

54 
	`årštf
(
¡d”r
,"æ— æ³•åˆ›å»ºæ–‡ä»¶!\n");

55 
	`ex™
(1);

58 *
åem
=
å_em¶oy“
;

59 *
å½
=
å_»w¬dpunish
;

62 *
åem
=
å_em¶oy“
;

63 *
å½
=
å_»w¬dpunish
;

66 
	}
}

	@init.h

1 
	~<¡dio.h
>

2 
	~"glob®.h
"

3 
GINFO
* 
š™_sys
();

4 
š™_fes
(
FILE
**,FILE**);

	@menu.c

1 
	~<¡dlib.h
>

2 
	~"m’u.h
"

3 
	$m’u
(
GINFO
 *
pgšfo
)

5 
sw
=0;

6 
FILE
 *
åem
=
NULL
;

9 
	`sy¡em
("clear");

10 
	`´štf
("------------Personnel Management System-----------\n");

11 
	`´štf
("1.å‘˜å·¥ä¿¡æ¯æ“ä½œ\n");

12 
	`´štf
("2.å‘˜å·¥å¥–æƒ©æ“ä½œ\n");

13 
	`´štf
("3.è®¡ç®—å‘˜å·¥å·¥èµ„\n");

14 
	`´štf
("4.é€€å‡º\n");

15 
	`´štf
("è¯·è¾“å…¥é€‰é¡¹:");

16 
	`sÿnf
("%d",&
sw
)==0)

18 
	`´štf
("è¯·è¾“å…¥æ­£ç¡®çš„é€‰é¡¹:");

19 
	`g‘ch¬
()!='\n');

21 
sw
)

24 
	`İ_emšfo
(
pgšfo
->
em_h—d
);

33 
åem
=
	`fİ’
("../data/emdata","r+");

34 if(
åem
==
NULL
)

36 
	`årštf
(
¡d”r
,"æ‰“å¼€å‘˜å·¥ä¿¡æ¯æ–‡ä»¶å¤±è´¥!\n");

37 
	`ex™
(0);

39 
pgšfo
->
em_couÁ
=
	`g‘_em¶oy“_couÁ
Õgšfo->
em_h—d
);

40 
pgšfo
->
emid
=emid;

41 
	`§ve_®l
(
åem
,
pgšfo
);

42 
	`fşo£
(
åem
);

45 
	`´štf
("è¯·è¾“å…¥æ­£ç¡®çš„é€‰é¡¹:");

50 
	}
}

51 
	$İ_emšfo
(
EMPLOYEE
* 
em_h—d
)

53 
sw
=0;

54 
dœtyd©a
=0;

55 
EMPLOYEE
* 
³m
=
NULL
;

56 
FILE
 *
åem
=
NULL
;

59 
	`sy¡em
("clear");

60 
	`£tbuf
(
¡dš
,
NULL
);

61 
	`´štf
("***************å‘˜å·¥ä¿¡æ¯æ“ä½œ***************\n");

62 
	`´štf
("1.æŸ¥çœ‹å‘˜å·¥ä¿¡æ¯\n");

63 
	`´štf
("2.æ·»åŠ å‘˜å·¥ä¿¡æ¯\n");

64 
	`´štf
("3.åˆ é™¤å‘˜å·¥ä¿¡æ¯\n");

65 
	`´štf
("4.è¿”å›ä¸Šå±‚\n");

66 
	`´štf
("è¯·è¾“å…¥é€‰é¡¹:");

67 
	`sÿnf
("%d",&
sw
)==0)

69 
	`´štf
("è¯·è¾“å…¥æ­£ç¡®çš„é€‰é¡¹:");

70 
	`£tbuf
(
¡dš
,
NULL
);

72 
sw
)

75 
	`show_®l_emšfo
(
em_h—d
);

78 
³m
=
	`šput_Úe_em¶oy“
();

79 if(
	`add_em¶oy“
(
em_h—d
,
³m
)==1)

81 
dœtyd©a
=1;

85 if(
	`d–‘e_em
(
em_h—d
)==1)

87 
dœtyd©a
=1;

91 if(
dœtyd©a
==1)

93 
åem
=
	`fİ’
("../data/emdata","r+");

94 if(
åem
==
NULL
)

96 
	`årštf
(
¡d”r
,"æ‰“å¼€å‘˜å·¥ä¿¡æ¯æ–‡ä»¶å¤±è´¥!\n");

97 
	`ex™
(0);

99 
	`§ve_em¶oy“s
(
åem
,
em_h—d
);

100 
dœtyd©a
=0;

101 
	`fşo£
(
åem
);

105 
	`´štf
("è¯·è¾“å…¥æ­£ç¡®çš„é€‰é¡¹:");

110 
	}
}

111 
	$d–‘e_em
(
EMPLOYEE
* 
em_h—d
)

113 
id
=0;

114 
	`´štf
("è¯·è¾“å…¥è¦åˆ é™¤å‘˜å·¥çš„å‘˜å·¥å·:");

115 
	`sÿnf
("%d",&
id
)==0)

117 
	`´štf
("è¯·è¾“å…¥è¦åˆ é™¤å‘˜å·¥çš„å‘˜å·¥å·:");

119  
	`d–‘e_em_by_id
(
em_h—d
,
id
);

120 
	}
}

	@menu.h

1 #iâdeà
_MENU_H


2 
	#_MENU_H


	)

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~"feİ.h
"

7 
	~"pmsio.h
"

8 
	~"glob®.h
"

10 
m’u
(
GINFO
 *
pgšfo
);

11 
İ_emšfo
(
EMPLOYEE
* 
em_h—d
);

	@pms.c

1 
	~<¡dio.h
>

2 
	~"š™.h
"

3 
	~"m’u.h
"

5 
	$maš
()

7 
GINFO
 *
pgšfo
=
NULL
;

8 
pgšfo
=
	`š™_sys
();

9 
	`m’u
(
pgšfo
);

11 
	}
}

	@pmsio.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~"pmsio.h
"

4 
EMPLOYEE
 *
	$šput_Úe_em¶oy“
()

6 
t™Ë
=-1;

7 
EMPLOYEE
* 
³m
=(EMPLOYEE*)
	`m®loc
((EMPLOYEE));

8 
	`´štf
("è¯·è¾“å…¥å‘˜å·¥å§“å:");

9 
	`sÿnf
("%31s",
³m
->
Çme
);

10 
	`´štf
("å‘˜å·¥èŒç§°\n1.åˆçº§\t2.é«˜çº§\t3.é«˜çº§\nè¯·é€‰æ‹©:");

11 
	`sÿnf
("%d",&
t™Ë
)==0)

13 
	`´štf
("è¯·è¾“å…¥æ­£ç¡®é€‰é¡¹:");

15 
³m
->
t™Ë
=title;

16 
³m
->
§Ïy
=1000*
t™Ë
;

17 
³m
->
Úlše
=1;

18 
³m
->
id
=++
emid
;

20 
	}
}

21 
RP
 * 
	$šput_Úe_»w¬dpunish
()

24 
	}
}

	@pmsio.h

1 #iâdeà
_PMSIO_H


2 
	#_PMSIO_H


	)

4 
	~"em¶oy“.h
"

5 
	~"»w¬dpunish.h
"

6 
EMPLOYEE
 *
šput_Úe_em¶oy“
();

7 
RP
 *
šput_Úe_»w¬dpunish
();

	@rewardpunish.c

	@rewardpunish.h

1 #iâdeà
_REWARDPUNISH_H


2 
	#_REWARDPUNISH_H


	)

4 #iâdeà
_RPFLAG


5 
	#_RPFLAG


	)

8 
	#RP_SAVE_SIZE
 ((
RP
))

9 

	)

10 
	s»w¬d_punish


12 
	mid
;

13 #ifdeà
_RPFLAG


14 
	m½æag
;

16 
	mmÚey
;

17 
	md©a
;

18 
	mdesütiÚ
[128];

19 
»w¬d_punish
* 
	mÃxt
;

20 }
	tRP
;

	@
1
.
0
14
129
employee.c
employee.h
fileop.c
fileop.h
global.h
init.c
init.h
menu.c
menu.h
pms.c
pmsio.c
pmsio.h
rewardpunish.c
rewardpunish.h
